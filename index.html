<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Emergency Service Directory</title>
  <link rel="icon" href="assets/logo.png">
  <style>
    :root{
      --bg: #0b1b13;
      --brand-700: #0f6d5b;
      --brand-600: #0f8b6d;
      --brand-500: #10b981;
      --brand-400: #34d399;
      --brand-300: #6ee7b7;
      --emerald: #065f46;
      --teal: #0f766e;
      --green: #16a34a;
      --sky: #0284c7;
      --blue: #2563eb;
      --slate-900:#0f172a;
      --slate-800:#1e293b;
      --slate-700:#334155;
      --slate-600:#475569;
      --slate-500:#64748b;
      --slate-400:#94a3b8;
      --slate-300:#cbd5e1;
      --slate-200:#e2e8f0;
      --slate-100:#f1f5f9;
      --white:#ffffff;
      --card:#ffffff;
      --muted:#6b7280;
      --success:#10b981;
      --danger:#ef4444;
      --warning:#f59e0b;
    }

    *{ box-sizing:border-box; }
    html,body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      color:#0b1220;
      background: #f6faf8;
    }

    /* Navbar */
    .navbar{
      position:sticky;
      top:0;
      z-index:50;
      background: linear-gradient(90deg, var(--emerald), var(--teal));
      color: var(--white);
      border-bottom: 1px solid rgba(255,255,255,.08);
      box-shadow: 0 2px 10px rgba(0,0,0,.08);
    }
    .nav-wrap{ 
      max-width: 1200px; margin:0 auto; 
      display:flex; align-items:center; justify-content:space-between;
      padding: 10px 16px;
    }
    .brand{
      display:flex; align-items:center; gap:10px; font-weight:700; letter-spacing:.3px;
    }
    .brand img{ width:34px; height:34px; object-fit:contain; border-radius:999px; background:#fff; padding:2px; }
    .metrics{ display:flex; align-items:center; gap:14px; font-weight:600; }
    .metric{
      display:flex; align-items:center; gap:6px; background: rgba(255,255,255,.12);
      border: 1px solid rgba(255,255,255,.15);
      padding:6px 10px; border-radius:999px;
      backdrop-filter: blur(8px);
    }
    .metric img{ width:18px; height:18px; object-fit:contain; }
    .metric .count{min-width:28px; text-align:right;}

    /* Hero */
    .hero{
      background: radial-gradient(1200px 500px at 50% -50%, rgba(20,184,166,.25), transparent),
                  linear-gradient(180deg, rgba(13,148,136,.18), rgba(15,118,110,.18)),
                  linear-gradient(180deg, #083d34, #0a2f29);
      color:#eafdf6;
    }
    .hero-wrap{ 
      max-width: 1100px; margin:0 auto;
      padding: 28px 16px 20px 16px; text-align:center; position:relative;
    }
    .hero .crest{
      width: 76px; height: 76px; object-fit:contain; 
      border-radius:999px; background:#fff; padding:8px; box-shadow:0 4px 16px rgba(0,0,0,.25);
      display:block; margin:0 auto 10px auto;
    }
    .hero h1{
      margin:0;
      font-size: clamp(20px, 5vw, 28px);
      letter-spacing:.2px; font-weight:800;
    }
    .hero .slogan{
      margin-top:10px; font-size:13.5px; color:#cdebe2;
    }

    /* Main layout */
    .main{
      max-width:1200px; margin:18px auto; padding: 0 16px 40px;
      display:grid; grid-template-columns: 1fr; gap:16px;
    }
    @media (min-width: 1024px){
      .main{ grid-template-columns: 2fr 1fr; align-items:start; }
    }

    /* Card grid */
    .cards{ display:grid; grid-template-columns: 1fr; gap:14px; }
    @media (min-width: 640px){ .cards{ grid-template-columns: repeat(2, 1fr);} }
    @media (min-width: 900px){ .cards{ grid-template-columns: repeat(3, 1fr);} }

    .card{
      position:relative; background: var(--card); border-radius:14px;
      border:1px solid var(--slate-200);
      box-shadow: 0 6px 14px rgba(2, 6, 12, .05);
      padding:14px; display:flex; flex-direction:column; gap:10px;
      transition: transform .18s ease, box-shadow .18s ease;
    }
    .card:hover{ transform: translateY(-2px); box-shadow: 0 10px 20px rgba(2,6,12,.08); }
    .card-top{ display:flex; align-items:center; justify-content:space-between; }
    .badge{ font-size:11px; padding:4px 8px; border-radius:999px; background:#eefaf5; color:#0b6b53; border:1px solid #ccefe3; }
    .heart-btn{
      position:absolute; top:8px; left:8px;
      border:none; background:#fff; border:1px solid var(--slate-200);
      width:30px; height:30px; border-radius:10px; cursor:pointer;
      display:grid; place-items:center; transition:background .15s;
    }
    .heart-btn:hover{ background:#f3f4f6; }
    .heart-btn img{ width:18px; height:18px; }
    .service{
      display:flex; align-items:center; gap:10px; padding-left:32px; /* to avoid overlapping heart */
    }
    .service img{ width:38px; height:38px; object-fit:contain; }
    .names{ line-height:1.2; }
    .name-en{ font-weight:700; }
    .name-bn{ font-size:12.5px; color:var(--muted); }
    .hotline{ font-weight:800; font-size:20px; letter-spacing:.5px; }
    .actions{ display:flex; gap:8px; margin-top:6px; }
    .btn{
      flex:1; display:flex; align-items:center; justify-content:center; gap:8px;
      border:1px solid var(--slate-300); background:#fff; color:#0b1220;
      padding:10px 12px; border-radius:10px; cursor:pointer; font-weight:700;
      transition: all .15s ease;
    }
    .btn:hover{ transform: translateY(-1px); box-shadow: 0 6px 10px rgba(2,6,12,.08); }
    .btn.copy::before{ content:"üìã"; }
    .btn.call{ background:#0ea5a8; border-color:#0ea5a8; color:white; }
    .btn.call::before{ content:"üìû"; }
    .btn:disabled{ opacity:.55; filter:grayscale(70%); cursor:not-allowed; }

    /* History */
    .history{
      background: var(--white); border-radius:14px; border:1px solid var(--slate-200);
      box-shadow: 0 8px 18px rgba(2,6,12,.05);
      position:relative; overflow:hidden;
    }
    .history-head{
      display:flex; align-items:center; justify-content:space-between; padding:12px 14px;
      background: #fbfdfc; border-bottom:1px solid var(--slate-200);
    }
    .history-title{ display:flex; align-items:center; gap:8px; font-weight:800; }
    .history-title::before{ content:'üîî'; }
    .history-clear{
      border:1px solid var(--slate-300); padding:8px 10px; border-radius:10px; background:#fff; cursor:pointer; font-weight:700;
    }
    .history-list{ list-style:none; margin:0; padding:6px 0; max-height: 520px; overflow:auto; }
    .entry{
      display:grid; grid-template-columns: 1fr auto; gap:8px; align-items:center;
      padding:10px 14px; border-bottom:1px dashed var(--slate-200);
    }
    .entry:last-child{ border-bottom:none; }
    .entry .service-name{ font-weight:700; }
    .entry small{ color:var(--muted); }

    .sr-only{ position:absolute !important; height:1px; width:1px; overflow:hidden; clip:rect(1px,1px,1px,1px); white-space:nowrap; }
    a,button{ font-family:inherit; }
  </style>
</head>
<body>
  <!-- Navbar -->
  <header class="navbar">
    <div class="nav-wrap">
      <div class="brand">
        <img src="assets/logo.png" alt="Logo">
        <div>
          <div style="font-size:15px; line-height:1;">Emergency Service</div>
          <div style="font-size:12px; opacity:.9;">Directory</div>
        </div>
      </div>
      <div class="metrics">
        <div class="metric" title="Favourites">
          <img src="assets/heart.png" alt="heart">
          <span>Hearts</span>
          <span class="count" id="heartCount">0</span>
        </div>
        <div class="metric" title="Coins">
          <img src="assets/coin.png" alt="coin">
          <span>Coins</span>
          <span class="count" id="coinCount">100</span>
        </div>
        <div class="metric" title="Copy Count">
          <span>Copies</span>
          <span class="count" id="copyCount">0</span>
        </div>
      </div>
    </div>
  </header>

  <!-- Hero -->
  <section class="hero">
    <div class="hero-wrap">
      <img class="crest" src="assets/logo-dark.png" alt="Gov Crest">
      <h1>Emergency Service Directory</h1>
      <p class="slogan">Government Emergency Services at Your Fingertips ‚Äî A Project by Government of the People‚Äôs Republic of Bangladesh</p>
    </div>
  </section>

  <!-- Main -->
  <main class="main">
    <!-- Cards -->
    <section class="cards" id="cardGrid">
      <!-- Cards will be injected by JS -->
    </section>

    <!-- History -->
    <aside class="history">
      <div class="history-head">
        <div class="history-title">Call History</div>
        <button id="clearHistory" class="history-clear">Clear</button>
      </div>
      <ul id="historyList" class="history-list">
        <!-- dynamic -->
      </ul>
    </aside>
  </main>

  <script>
    // ------- State -------
    const state = {
      hearts: 0,
      coins: 100,
      copies: 0,
      history: []
    };

    const services = [
      {
        id:'national-999',
        nameEn:'National Emergency Number',
        nameBn:'‡¶ú‡¶æ‡¶§‡ßÄ‡¶Ø‡¶º ‡¶ú‡¶∞‡ßÅ‡¶∞‡¶ø ‡¶∏‡ßá‡¶¨‡¶æ',
        number:'999',
        category:'All',
        icon:'assets/emergency.png'
      },
      {
        id:'police-999',
        nameEn:'Police Helpline Number',
        nameBn:'‡¶™‡ßÅ‡¶≤‡¶ø‡¶∂',
        number:'999',
        category:'Police',
        icon:'assets/police.png'
      },
      {
        id:'fire-999',
        nameEn:'Fire Service Number',
        nameBn:'‡¶´‡¶æ‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶ø‡¶∏',
        number:'999',
        category:'Fire',
        icon:'assets/fire-service.png'
      },
      {
        id:'ambulance-1994',
        nameEn:'Ambulance Service',
        nameBn:'‡¶Ö‡ßç‡¶Ø‡¶æ‡¶Æ‡ßç‡¶¨‡ßÅ‡¶≤‡ßá‡¶®‡ßç‡¶∏',
        number:'1994-999999',
        category:'Health',
        icon:'assets/ambulance.png'
      },
      {
        id:'women-109',
        nameEn:'Women & Child Helpline',
        nameBn:'‡¶®‡¶æ‡¶∞‡ßÄ ‡¶ì ‡¶∂‡¶ø‡¶∂‡ßÅ ‡¶∏‡ßÅ‡¶∞‡¶ï‡ßç‡¶∑‡¶æ',
        number:'109',
        category:'Govt.',
        icon:'assets/heart.png'
      },
      {
        id:'anti-106',
        nameEn:'Anti-Corruption Helpline',
        nameBn:'‡¶¶‡ßÅ‡¶∞‡ßç‡¶®‡ßÄ‡¶§‡¶ø ‡¶¶‡¶Æ‡¶®',
        number:'106',
        category:'Govt.',
        icon:'assets/logo.png'
      },
      {
        id:'electricity-16216',
        nameEn:'Electricity Helpline',
        nameBn:'‡¶¨‡¶ø‡¶¶‡ßç‡¶Ø‡ßÅ‡ßé ‡¶¨‡¶ø‡¶ö‡ßç‡¶õ‡¶ø‡¶®‡ßç‡¶®',
        number:'16216',
        category:'Electricity',
        icon:'assets/energy.png' // fallback if not present
      },
      {
        id:'brac-16445',
        nameEn:'Brac Helpline',
        nameBn:'‡¶¨‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶ï',
        number:'16445',
        category:'NGO',
        icon:'assets/brac.png'
      },
      {
        id:'rail-163',
        nameEn:'Bangladesh Railway Helpline',
        nameBn:'‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂ ‡¶∞‡ßá‡¶≤‡¶ì‡¶Ø‡¶º‡ßá',
        number:'163',
        category:'Railway',
        icon:'assets/Bangladesh-Railway.png'
      }
    ];

    // ------- Helpers -------
    const el = sel => document.querySelector(sel);
    const fmtTime = d => {
      // e.g., "11:36:58 AM"
      return d.toLocaleTimeString([], {hour:'2-digit', minute:'2-digit', second:'2-digit'});
    };

    const updateNavbar = () => {
      el('#heartCount').textContent = state.hearts;
      el('#coinCount').textContent = state.coins;
      el('#copyCount').textContent = state.copies;
    };

    const renderCards = () => {
      const grid = el('#cardGrid');
      grid.innerHTML = services.map(s => `
        <article class="card" data-id="${s.id}" data-number="${s.number}" data-name="${s.nameEn}">
          <button class="heart-btn" title="Give a heart" data-action="heart">
            <img src="assets/heart.png" alt="heart">
            <span class="sr-only">Give heart</span>
          </button>

          <div class="card-top">
            <span class="badge">${s.category}</span>
          </div>

          <div class="service">
            <img src="${s.icon}" alt="${s.nameEn} icon" onerror="this.src='assets/emergency.png'">
            <div class="names">
              <div class="name-en">${s.nameEn}</div>
              <div class="name-bn">${s.nameBn}</div>
            </div>
          </div>

          <div class="hotline">${s.number}</div>

          <div class="actions">
            <button class="btn copy" data-action="copy">Copy</button>
            <button class="btn call" data-action="call">Call</button>
          </div>
        </article>
      `).join('');
    };

    const renderHistory = () => {
      const list = el('#historyList');
      if(state.history.length === 0){
        list.innerHTML = '<li class="entry"><span class="service-name" style="opacity:.6;">No calls yet.</span><small></small></li>';
        return;
      }
      list.innerHTML = state.history.map(h => `
        <li class="entry">
          <div>
            <div class="service-name">${h.name}</div>
            <small>${h.number}</small>
          </div>
          <small>${h.time}</small>
        </li>
      `).join('');
    };

    // ------- Actions -------
    const handleHeart = () => { state.hearts++; updateNavbar(); };
    const handleCopy = (name, number) => {
      // Clipboard copy with safe fallback
      const tryModern = async () => {
        if (navigator.clipboard && navigator.clipboard.writeText) {
          await navigator.clipboard.writeText(number);
          return true;
        }
        return false;
      };

      const legacyCopy = (text) => {
        const ta = document.createElement('textarea');
        ta.value = text;
        document.body.appendChild(ta);
        ta.select();
        try{ document.execCommand('copy'); }catch(e){}
        document.body.removeChild(ta);
      };

      tryModern().then(ok => {
        if(!ok) legacyCopy(number);
        alert(`üìã Copied ${name} number: ${number}`);
        state.copies++; updateNavbar();
      });
    };

    const handleCall = (name, number) => {
      if(state.coins < 20){
        alert('Not enough coins to make this call. You need at least 20 coins.');
        return;
      }
      state.coins -= 20;
      updateNavbar();
      alert(`üìû Calling ${name} (${number}) ...`);
      const time = fmtTime(new Date());
      state.history.unshift({name, number, time});
      renderHistory();
    };

    // Event Delegation for cards
    document.addEventListener('click', (e) => {
      const card = e.target.closest('.card');
      if(!card) return;

      const actionBtn = e.target.closest('[data-action]');
      if(!actionBtn) return;

      const name = card.getAttribute('data-name');
      const number = card.getAttribute('data-number');
      const action = actionBtn.getAttribute('data-action');

      if(action === 'heart'){ handleHeart(); }
      if(action === 'copy'){ handleCopy(name, number); }
      if(action === 'call'){ handleCall(name, number); }
    });

    // Clear history
    el('#clearHistory').addEventListener('click', () => {
      state.history = [];
      renderHistory();
    });

    // Init
    renderCards();
    renderHistory();
    updateNavbar();
  </script>
</body>
</html>
